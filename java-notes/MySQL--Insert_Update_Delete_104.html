<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Insert Update Delete</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Insert Update Delete</h1><br/><p></p><p><strong>Вставка данных</strong></p><p></p><p>Значение первичного ключа (PRIMARY KEY) должно быть уникальным (при вставке строки таблицы с существующим PRIMARY KEY появится ошибка)</p><p>Если PRIMARY KEY установлен автоинкремент (AI = Auto Incremental), то при вставке первичный ключ указывать не обязательно</p><p><strong>INSERT INTO employees (emp_no, birth_date, first_name, last_name, gender, hire_date) </strong></p><p><strong>VALUES (500001, &#39;1972-01-01&#39;, &#39;John&#39;, &#39;Doe&#39;, &#39;M&#39;, &#39;2000-02-12&#39;);</strong></p><p></p><p>Вставка сразу нескольких строк:</p><p><strong>INSERT INTO employees (emp_no, birth_date, first_name, last_name, gender, hire_date) </strong></p><p><strong>VALUES </strong></p><p><strong>(500001, &#39;1972-01-01&#39;, &#39;John&#39;, &#39;Doe&#39;, &#39;M&#39;, &#39;2000-02-12&#39;)</strong>,</p><p><strong>(500002, &#39;1972-02-02&#39;, &#39;John&#39;, &#39;Doe&#39;, &#39;M&#39;, &#39;2000-02-12&#39;),</strong></p><p><strong>(500003, &#39;1972-03-03&#39;, &#39;Jessica&#39;, &#39;Kelly&#39;, &#39;F&#39;, &#39;2000-02-12&#39;),</strong></p><p><strong>(500004, &#39;1972-04-04&#39;, &#39;Grant&#39;, &#39;Portman&#39;, &#39;M&#39;, &#39;2001-03-11&#39;);</strong></p><p></p><p><strong>Обновление данных</strong></p><p></p><p><strong>UPDATE employees SET hire_date = &#39;2020-03-13&#39; WHERE emp_no = 500001;</strong></p><p>	• SET - перечисление через запятую полей, которые хотим обновить</p><p>	• WHERE - на каких конкретно записях нужно обновить. Неправильное условие или его отсутствие может нанести вред всей таблице</p><p></p><p><strong>UPDATE users SET language = &#39;english,german&#39; WHERE id = 0;</strong> // language - тип данных “перечисление SET”</p><p></p><p><strong>Удаление данных</strong></p><p></p><p>Стратегия Hard delete - жесткое удаление</p><p><strong>DELETE FROM employees WHERE emp_no IN (500001, 500002, 500003, 500004);</strong></p><p>	• WHERE - условие, по которому удалять записи</p><p>	• IN - удалятся перечисленные записи, у которых emp_no = 500001, emp_no = 500002, emp_no = 500003, emp_no = 500004</p><p>Удалить всю таблицу (2 варианта):</p><p>	• <strong>DELETE FROM employees;</strong> // Запрос без условия</p><p>	• <strong>TRUNCATE TABLE employees;</strong></p><p></p><p></p><p>Стратегия Soft delete - данные не удаляются, а помечаются как удаленные</p><p>Для этого добавяем в таблицу еще одно поле: SCHEMAS / employees / Tables / employees / Пр.кн. / Alter Table / Добавляем столбец:</p><p><img src="images/104-1.png" alt="images/104-1.png" /></p><p>Для “удаления” обновляем запись:</p><p><strong>UPDATE employees SET deleted_at = NOW() WHERE emp_no = 499999;</strong> // Теперь строка emp_no = 499999 как будто удалена</p><p>Вывод всех данных, которые “не удалены”:</p><p><strong>SELECT</strong> <strong>* FROM employees WHERE deleted_at IS NULL ORDER BY emp_no DESC;</strong></p><p>Записи, которые “удалены”:</p><p><strong>SELECT</strong> <strong>* FROM employees WHERE deleted_at IS NOT NULL ORDER BY emp_no DESC;</strong></p><p>Восстановить “удаленную” запись:</p><p><strong>UPDATE employees SET deleted_at = NULL WHERE emp_no = 499999;</strong></p><p></p></div>
</body>
</html>
