<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Logging</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Logging</h1><br/><p></p><p><h2>Java.util.logging (JUL)</h2></p><p></p><p><span style="color:#595959;">Включен в стандарт, поставляется вместе с JDK, поэтому ничего дополнительно не нужно. Имеет следующие уровни логирования по возрастанию: FINEST, FINER, FINE, CONFIG, INFO, WARNING, SEVERE, а также ALL и OFF, включающий и отключающий все уровни соответственно.</span></p><p><span style="color:#595959;">Создается вызовом одного из статических методов класса java.util.logging.Logger:</span></p><p></p><p><strong><span style="color:#595959;">private static final Logger LOGGER = Logger.getLogger(YOURClass.class.getName());</span></strong><strong> </strong>// - логгер будет выводить информацию о классе и о потоке, где выполняется код. Чаще всего это объявляется как константа в каждом классе, о котором хотим добавить информацию в журнал.<strong></strong></p><p><strong></strong></p><p>.............</p><p></p><p><em><span style="color:#9876aa;">LOGGER</span></em><em>.log(Level.</em><em><span style="color:#9876aa;">INFO</span></em><em><span style="color:#cc7832;">, </span></em><em><span style="color:#6a8759;">&quot;Method run() starts&quot;</span></em><em>)</em><em><span style="color:#cc7832;">;</span></em> // Делаем запись в журнал в нужном месте кода</p><p></p><p><em><span style="color:#9876aa;">LOGGER</span></em><em>.log(Level.</em><em><span style="color:#9876aa;">INFO</span></em><em><span style="color:#cc7832;">, </span></em><em><span style="color:#6a8759;">&quot;Space is set {0}, {1}&quot;</span></em><em><span style="color:#cc7832;">, new </span></em><em>String[] {</em><em><span style="color:#6a8759;">&quot;param1&quot;</span></em><em><span style="color:#cc7832;">, </span></em><em><span style="color:#6a8759;">&quot;param2&quot;</span></em><em>})</em><em><span style="color:#cc7832;">;</span></em> // Строковое сообщение с параметрами</p><p></p><p>............</p><p></p><p>Для настройки <strong>JUL</strong> чтобы он сохранял в файл, ему нужен <strong>Handler</strong>:</p><p></p><p><strong><span style="color:#2b91af;">FileHandler </span></strong><strong><span style="color:#303336;">fh = </span></strong><strong><span style="color:#101094;">new</span></strong><strong><span style="color:#303336;"> </span></strong><strong><span style="color:#2b91af;">FileHandler</span></strong><strong><span style="color:#303336;">(</span></strong><strong><span style="color:#7d2727;">&quot;C:\\temp\test\MyLogFile.log&quot;</span></strong><strong><span style="color:#303336;">); </span></strong>// Файловый хендлер<strong></strong></p><p><strong></strong><strong><span style="color:#2b91af;">SimpleFormatter</span></strong><strong><span style="color:#303336;"> formatter = </span></strong><strong><span style="color:#101094;">new</span></strong><strong><span style="color:#303336;"> </span></strong><strong><span style="color:#2b91af;">SimpleFormatter</span></strong><strong><span style="color:#303336;">(); </span></strong>// Форматтер, который будет отвечать за форматирование сообщений в файле логгера<strong><span style="color:#303336;"></span></strong></p><p><strong><span style="color:#303336;">fh.setFormatter(formatter);</span></strong><strong> </strong></p><p><strong></strong><strong><span style="color:#303336;">LOG.addHandler(fh); </span></strong><strong> </strong>// Логгеру устанавливаем хендлер, можно добавить несколько хендлеров</p><p></p><p>Возможные хендлеры:</p><p><img src="images/21-1.png" alt="images/21-1.png" /><strong></strong></p><p><strong></strong></p><p><span style="color:#595959;">Выделяется две группы методов:</span></p><p></p><p><span style="color:#595959;">●название которых соответствует уровню логирования</span></p><p><span style="color:#595959;">// чаще и лучше использовать эту группу</span></p><p><span style="color:#595959;">○LOG.info(&quot;info&quot;); </span></p><p><span style="color:#595959;">LOG.warning(&quot;warning&quot;); </span></p><p><span style="color:#595959;">LOG.severe(&quot;severe&quot;);</span> </p><p></p><p><span style="color:#595959;">●методы log, loggp, logrb, принимающие уровень логирования в качестве параметра с типом Level. </span>// лучше использовать в случае, если мы хотим какой-то свой кастомный логгер изобрести, в котором будем писать какую-то логику в зависимости от уровня.<span style="color:#595959;"></span></p><p><span style="color:#595959;">○LOG.log(new LogRecord(Level.INFO, stringMessage));</span></p><p><span style="color:#595959;">○LOG.logp(Level.INFO, &quot;ClassName&quot;, &quot;MethodName&quot;, stringMessage);</span></p><p><span style="color:#595959;">○LOG.logrb(Level.INFO, &quot;ClassName&quot;, &quot;MethodName&quot;, resourceBundle, &quot;messageId&quot;);</span></p><p><span style="color:#595959;">○LOG.throwing(&quot;ClassName&quot;,&quot;MethodName&quot;, throwable);</span></p><p></p><p><h3>JUL Config</h3></p><p></p><p>Для задания способа вывода сообщений необходимо указать какие хендлеры он будет использовать.</p><p><strong><span style="color:#595959;">FileHandler, ConsoleHandler, StreamHandler, SocketHandler, MemoryHandler.</span></strong><strong></strong></p><p><strong></strong></p><p><strong></strong>Настройки хендлеров задаются в целом для всего класса, а не для конкретного экземпляра, что может порождать проблемы, если вам потребуется сообщения различных логгеров выводить в различные файлы или с различным форматированием.</p><p></p><p>Лучше использовать конфигурационный файл. (Если сконфигурировать JUL в коде, прийдется перекомпилировать приложение, если нужно будет изменить уровень логирования)</p><p>Пример конфигурационного файла:</p><p><strong><span style="color:#333333;"># Настройки глобального логгера</span></strong></p><p><strong><span style="color:#333333;"> handlers =java.util.logging.FileHandler // хендлер, который нужен, с полным путем</span></strong></p><p><strong><span style="color:#333333;"> </span></strong></p><p><strong><span style="color:#333333;"> # Конфигурация файлового хендлера</span></strong></p><p><strong><span style="color:#333333;"> java.util.logging.FileHandler.level =ALL</span></strong></p><p><strong><span style="color:#333333;"> java.util.logging.FileHandler.formatter =java.util.logging.SimpleFormatter</span></strong></p><p><strong><span style="color:#333333;"> java.util.logging.FileHandler.limit = </span></strong><strong><span style="color:#008080;">1000000</span></strong><strong> // ротейшн, указать размер в байтах для файла</strong><strong><span style="color:#333333;"></span></strong></p><p><strong><span style="color:#333333;"> java.util.logging.FileHandler.pattern   = log.txt</span></strong></p><p><strong><span style="color:#333333;"> # Конфигурация консольного хендлера</span></strong></p><p><strong><span style="color:#333333;"> java.util.logging.ConsoleHandler.level = ALL</span></strong></p><p><strong><span style="color:#333333;"> java.util.logging.ConsoleHandler.pattern = log.log // имя файла</span></strong></p><p><strong><span style="color:#333333;"> java.util.logging.ConsoleHandler.formatter =java.util.logging.SimpleFormatter</span></strong><strong> // форматирование файла</strong></p><p><strong> </strong></p><p><strong></strong><strong><span style="color:#333333;">Чтобы JUL применил данную конфигурацию нужно передать параметр -Djava.util.logging.config.file = &lt;путь к файлу&gt;, либо при старте приложения выполнить код:</span></strong><strong></strong></p><p><strong></strong><strong><span style="color:#333333;">LogManager.getLogManager().readConfiguration(&lt;ваш класс&gt;.class.getResourceAsStream(&quot;logging.properties&quot;));</span></strong><strong></strong></p><p><strong></strong></p><p><strong>---------------------------------------------------</strong></p><p><strong></strong></p><p><strong></strong>JUL не очень хорошо работает: у него есть ограничения, он не очень универсальный. Поэтому он не очень широко используется.</p><p></p><p>Более широко используется библиотека<h2> Log4j</h2>, более гибкая</p><p></p><p>log4shell - уязвимость, обнаруженная в этой библиотеке</p><p></p></div>
</body>
</html>
